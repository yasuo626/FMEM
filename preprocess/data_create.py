import pandas as pd
import math
import numpy as np
def create_embeds():
    pass

def create_labels():
    pass

def generate_labels(path_or_df,label,k,by=None,method='nunique',show=False):
    """
    get top-k labels for label col by selecting from each by_groups which is classified by [by].
    :param method: [nunique,freq] nunique:weigh by each group unique class nums,freq:weigh by each group sample frequency
    :param path_or_df: (DF/str) dataframe or path
    :param label: (str)the name of label col
    :param k:(int) the num of select labels
    :param by: (list) the cols list which use to groupby
    :param show: (bool) show the statistics table?
    :return: (numpy.array)[k,] the label values which selected
    :return:
    """
    if isinstance(path_or_df,str):
        df=pd.read_csv(path_or_df,sep='\t')
    else:
        df=path_or_df
    if by is None:
        return df.groupby([label]).count().iloc[:,0].reset_index(name='freq').sort_values(by='freq',ascending=False).reset_index(drop=True).loc[:k-1,label].values


    g = df.groupby(by).count()
    assert len(g) <= k and k < len(df.groupby(label))
    assert method in ['nunique','freq']
    uniquen = []
    for x in df.groupby(by).groups.items():
        uniquen.append(len(pd.unique(df.loc[x[1], label])))
    g['nunique'] = uniquen
    if method=='freq':
        s = g[label].sum()
        g['freq'] = g[label].map(lambda x: x / s)
        g['nassign'] = g['freq'].map(lambda x: math.floor(x * k))
        g = g.sort_values(by=label, ascending=False)
    else:
        s = g['nunique'].sum()
        g['freq'] = g['nunique'].map(lambda x: x / s)
        g['nassign'] = g['freq'].map(lambda x: math.floor(x * k))
        g = g.sort_values(by='nunique', ascending=False)
    lest = k - g['nassign'].sum()
    y = [lest]
    def assign_lest(x, y):
        if y[0] <= 0:
            return x
        allow = x['nunique'] - x['nassign']
        if y[0] <= allow:
            x['nassign'] += y[0]
            y[0] = 0
            return x
        x['nassign'] += allow
        y[0] -= allow
        return x
    g = g.apply(assign_lest, axis=1, args=(y,))
    if show:
        print(g)
    labels = np.empty([k],dtype=df.dtypes[label])
    last = 0
    for l in df.groupby(by).groups.items():
        num = int(g.loc[l[0], 'nassign'])
        # print(df[df.index.isin(l[1])].groupby(label).count().iloc[:, 0].reset_index(name='freq').sort_values(by='freq',ascending=False))
        labels[last:last + num] =df[df.index.isin(l[1])].groupby(label).count().iloc[:, 0]\
         .reset_index(name='freq').sort_values(by='freq',ascending=False)[label].values[:num]
        last += num
    return np.array(list(set(labels)))

def get_labels(tids,num_labels):
    term_labels=generate_labels(train_terms,'term',num_labels,by=['aspect'],show=False)
    terms_used = tterms[(tterms.term.isin(term_labels)) & (tterms.EntryID.isin(tids))]
    id_labels = terms_used.groupby('EntryID')['term'].apply(list).to_dict()
    term2idx = {label: i for i, label in enumerate(term_labels)}


    labels_matrix = np.zeros((len(tids), len(term_labels)))
    for index,i in enumerate(tids):
        # add label with [] which id was droped.
        if i not in id_labels.keys():
            id_labels[i]=[]
        idxs=[term2idx[term] for term in term_labels if term in id_labels[i]]
        labels_matrix[index, idxs] = 1
    return labels_matrix


# x=generate_labels(r'C:\Users\23920\Desktop\research\demo\dataset\cafa-5-protein-function-prediction\Train\train_terms.tsv','term',by='aspect',show=True,k=100)
# terms=pd.read_csv(r'C:\Users\23920\Desktop\research\demo\dataset\cafa-5-protein-function-prediction\Train\train_terms.tsv',sep='\t')
# terms = terms.groupby(['aspect', 'term'])['term'].count().reset_index(name='frequency')
# print(terms.groupby('aspect')['term'].nunique())
#
# fractions = (terms.groupby('aspect')['term'].nunique() / terms['term'].nunique() * 500).apply(round)
# print(fractions)
# selected_terms = set()
# for aspect, number in fractions.items():
#     selection = terms.loc[(terms.aspect == aspect)]
#     selection = selection.nlargest(number, columns='frequency', keep='first')
#     selected_terms.update(selection.term.to_list())
# y=np.array(list(selected_terms))
# x=np.array(['GO:0003002', 'GO:0016811', 'GO:1901605', 'GO:1901265', 'GO:0060589', 'GO:0030246', 'GO:0030031', 'GO:0016836', 'GO:0048869', 'GO:0009799', 'GO:0006810', 'GO:0005096', 'GO:0019001', 'GO:0009058', 'GO:0040007', 'GO:0032990', 'GO:0008015', 'GO:0140657', 'GO:0001067', 'GO:0003924', 'GO:0015630', 'GO:0098590', 'GO:0071704', 'GO:0099536', 'GO:1903506', 'GO:0009855', 'GO:0016567', 'GO:0003700', 'GO:0015711', 'GO:0031324', 'GO:0060284', 'GO:0048880', 'GO:0071702', 'GO:0005126', 'GO:0010629', 'GO:0046700', 'GO:0140352', 'GO:0042803', 'GO:0099568', 'GO:0010468', 'GO:0000987', 'GO:0006897', 'GO:0097708', 'GO:0031325', 'GO:0048477', 'GO:0010605', 'GO:0010035', 'GO:0005622', 'GO:0006974', 'GO:0002009', 'GO:0060548', 'GO:0060089', 'GO:0045893', 'GO:1901576', 'GO:1901363', 'GO:0072657', 'GO:0060537', 'GO:0008092', 'GO:0043168', 'GO:0008152', 'GO:0045202', 'GO:0045859', 'GO:0009790', 'GO:0007417', 'GO:0048699', 'GO:0005739', 'GO:0005543', 'GO:0005654', 'GO:0044297', 'GO:0016747', 'GO:0048729', 'GO:0046394', 'GO:0016791', 'GO:0010941', 'GO:0048568', 'GO:0008219', 'GO:0070062', 'GO:0046872', 'GO:1901137', 'GO:0033043', 'GO:0010628', 'GO:0016830', 'GO:1902074', 'GO:0001216', 'GO:0072521', 'GO:0019219', 'GO:0044260', 'GO:0016049', 'GO:0006796', 'GO:0006996', 'GO:0022857', 'GO:0031410', 'GO:0010033', 'GO:0030335', 'GO:0031975', 'GO:0016829', 'GO:0006338', 'GO:0055085', 'GO:0030182', 'GO:0019904', 'GO:0032561', 'GO:0035239', 'GO:0050790', 'GO:0051701', 'GO:0000323', 'GO:0008104', 'GO:0010243', 'GO:0009653', 'GO:0060429', 'GO:0008168', 'GO:0009408', 'GO:0016616', 'GO:0035295', 'GO:0003007', 'GO:0070013', 'GO:0000122', 'GO:1903508', 'GO:0003712', 'GO:0003729', 'GO:1902533', 'GO:0044237', 'GO:0016301', 'GO:0030695', 'GO:0042692', 'GO:0001775', 'GO:0061061', 'GO:0009059', 'GO:0042393', 'GO:0022008', 'GO:0045935', 'GO:0060341', 'GO:0007276', 'GO:0098772', 'GO:0065003', 'GO:0051241', 'GO:0046907', 'GO:0003006', 'GO:0002376', 'GO:0050778', 'GO:0016772', 'GO:0051240', 'GO:0050804', 'GO:0019222', 'GO:0002831', 'GO:0051493', 'GO:0008380', 'GO:0000981', 'GO:0048569', 'GO:0030155', 'GO:0031982', 'GO:0016818', 'GO:0001217', 'GO:0005694', 'GO:0015085', 'GO:0016817', 'GO:0043010', 'GO:0005975', 'GO:0048812', 'GO:0015631', 'GO:0032502', 'GO:0140097', 'GO:0006518', 'GO:0010720', 'GO:0007165', 'GO:0010467', 'GO:0044782', 'GO:0048667', 'GO:0033993', 'GO:0030414', 'GO:0001934', 'GO:0044389', 'GO:0031974', 'GO:0007600', 'GO:0045927', 'GO:0001667', 'GO:0046486', 'GO:0043009', 'GO:0032101', 'GO:0031347', 'GO:0042330', 'GO:0005768', 'GO:0003824', 'GO:0032880', 'GO:0048523', 'GO:0000003', 'GO:0048563', 'GO:0048609', 'GO:0034645', 'GO:0006091', 'GO:1902531', 'GO:0090304', 'GO:0048638', 'GO:0048514', 'GO:0007154', 'GO:0002064', 'GO:0071310', 'GO:0051093', 'GO:0016757', 'GO:0098916', 'GO:0016020', 'GO:0032501', 'GO:0051173', 'GO:0055086', 'GO:0031981', 'GO:0031967', 'GO:1901362', 'GO:0007517', 'GO:0016746', 'GO:0005085', 'GO:0006811', 'GO:1901361', 'GO:0062012', 'GO:0051052', 'GO:0007005', 'GO:0048285', 'GO:1901701', 'GO:0120035', 'GO:0032787', 'GO:0007267', 'GO:0030545', 'GO:0004888', 'GO:0006935', 'GO:0022803', 'GO:0002237', 'GO:0070161', 'GO:0016462', 'GO:0009267', 'GO:0048232', 'GO:0010942', 'GO:0009791', 'GO:0051656', 'GO:0001501', 'GO:1901698', 'GO:0048731', 'GO:0009057', 'GO:0065008', 'GO:0001932', 'GO:0006793', 'GO:0043436', 'GO:0005102', 'GO:0019902', 'GO:0015294', 'GO:2000241', 'GO:0009890', 'GO:0006807', 'GO:0009607', 'GO:0022613', 'GO:0023052', 'GO:0007409', 'GO:0032940', 'GO:0071345', 'GO:0051094', 'GO:0019220', 'GO:0033365', 'GO:0031401', 'GO:0007548', 'GO:0042802', 'GO:0012501', 'GO:0030546', 'GO:0031966', 'GO:0023051', 'GO:0019693', 'GO:0016787', 'GO:0031344', 'GO:0044248', 'GO:0005794', 'GO:0071495', 'GO:0007059', 'GO:0071944', 'GO:0010648', 'GO:0042742', 'GO:0045597', 'GO:0048585', 'GO:0006396', 'GO:0055080', 'GO:0042175', 'GO:1902680', 'GO:0008514', 'GO:0009117', 'GO:0045229', 'GO:0018130', 'GO:0009605', 'GO:0048858', 'GO:0045165', 'GO:0048562', 'GO:0003676', 'GO:0031668', 'GO:0030001', 'GO:0061659', 'GO:0034654', 'GO:0009968', 'GO:0000904', 'GO:0036293', 'GO:0051130', 'GO:0009416', 'GO:0010558', 'GO:0010608', 'GO:0071396', 'GO:0006790', 'GO:0097659', 'GO:0099177', 'GO:0060271', 'GO:0098609', 'GO:0004553', 'GO:0040012', 'GO:0005976', 'GO:0015276', 'GO:0060560', 'GO:0010556', 'GO:0098542', 'GO:0002682', 'GO:0006812', 'GO:0032870', 'GO:0070482', 'GO:0043226', 'GO:0012505', 'GO:0008047', 'GO:0048518', 'GO:0050877', 'GO:0032559', 'GO:0010256', 'GO:0070727', 'GO:0120031', 'GO:0104004', 'GO:0030424', 'GO:0008134', 'GO:0003013', 'GO:0090066', 'GO:0007268', 'GO:0048732', 'GO:0043603', 'GO:0044282', 'GO:0007018', 'GO:1901566', 'GO:0000280', 'GO:0006720', 'GO:0034762', 'GO:0044281', 'GO:0061630', 'GO:0005886', 'GO:0010927', 'GO:1901565', 'GO:0015081', 'GO:0030030', 'GO:0044238', 'GO:0048598', 'GO:0005730', 'GO:0009967', 'GO:0071214', 'GO:0009952', 'GO:1901564', 'GO:0006397', 'GO:0051253', 'GO:0044249', 'GO:0010038', 'GO:0048018', 'GO:0051716', 'GO:0051707', 'GO:0044271', 'GO:0001817', 'GO:0043434', 'GO:0004175', 'GO:0007010', 'GO:0043068', 'GO:0052689', 'GO:0005215', 'GO:0019752', 'GO:0007399', 'GO:0010646', 'GO:0051252', 'GO:0006281', 'GO:0042327', 'GO:0044255', 'GO:0050890', 'GO:0005618', 'GO:0050776', 'GO:0018193', 'GO:0006629', 'GO:0044265', 'GO:0009991', 'GO:0051336', 'GO:0009617', 'GO:0048707', 'GO:0044093', 'GO:0098827', 'GO:0061564', 'GO:0032103', 'GO:0022836', 'GO:0043232', 'GO:0003779', 'GO:0016310', 'GO:0071840', 'GO:0045934', 'GO:0080135', 'GO:0016209', 'GO:0061135', 'GO:0034660', 'GO:0000278', 'GO:0006979', 'GO:0033036', 'GO:2000147', 'GO:0000976', 'GO:0035639', 'GO:0005261', 'GO:0051603', 'GO:0007346', 'GO:0031327', 'GO:0042981', 'GO:0150063', 'GO:0051179', 'GO:0022607', 'GO:0023056', 'GO:0042127', 'GO:0022603', 'GO:0003690', 'GO:0005509', 'GO:0034330', 'GO:0009266', 'GO:0045944', 'GO:0034097', 'GO:0006259', 'GO:0043933', 'GO:0051046', 'GO:0019941', 'GO:0071496', 'GO:0065007', 'GO:0051020', 'GO:0016705', 'GO:0010638', 'GO:0009894', 'GO:0048878', 'GO:0072594', 'GO:0035556', 'GO:0016491', 'GO:0031984', 'GO:0140694', 'GO:0031267', 'GO:0051174', 'GO:0000902', 'GO:0051234', 'GO:0043230', 'GO:0006417', 'GO:0005216', 'GO:0043231', 'GO:0098662', 'GO:0046903', 'GO:0031012', 'GO:0031323', 'GO:0006351', 'GO:0022853', 'GO:0044283', 'GO:0022414', 'GO:0140513', 'GO:1990234', 'GO:0051606', 'GO:0030003', 'GO:0098813', 'GO:0043269', 'GO:0008233', 'GO:0006952', 'GO:2001141', 'GO:0099081', 'GO:0043229', 'GO:0140678', 'GO:0008234', 'GO:0009507', 'GO:0048856', 'GO:0030312', 'GO:0071407', 'GO:1901360', 'GO:0005634', 'GO:0048608', 'GO:0045184', 'GO:0031667', 'GO:0030554', 'GO:0031349', 'GO:0051049', 'GO:0036211', 'GO:0010562', 'GO:1903530', 'GO:0140101', 'GO:0031625', 'GO:0009891', 'GO:0046873', 'GO:0050865', 'GO:1903047', 'GO:0004721', 'GO:0042578', 'GO:0045595', 'GO:0017111', 'GO:0007552', 'GO:0044403', 'GO:0016853', 'GO:0043549', 'GO:0051321', 'GO:0004672', 'GO:0017076', 'GO:0042995', 'GO:0040011', 'GO:0005815', 'GO:0007167', 'GO:0030162', 'GO:0044270', 'GO:0006644', 'GO:0044877', 'GO:0009628', 'GO:0045596', 'GO:1901681', 'GO:0043085', 'GO:0060255', 'GO:0007166', 'GO:0043065', 'GO:0140677', 'GO:0016407', 'GO:0007281', 'GO:1901702', 'GO:0044057', 'GO:0051640', 'GO:0050839', 'GO:0050794', 'GO:0006082', 'GO:0008150', 'GO:0006955', 'GO:0090596', 'GO:0032774', 'GO:0070848', 'GO:0003677', 'GO:0022804', 'GO:1990904', 'GO:2000112', 'GO:0003723', 'GO:0016874', 'GO:0006355', 'GO:0009893', 'GO:0044085', 'GO:0006631', 'GO:0007610', 'GO:0007283', 'GO:0050767', 'GO:0043207', 'GO:0007389', 'GO:0034220', 'GO:0006915', 'GO:0034248', 'GO:0009314', 'GO:0015318', 'GO:0019637', 'GO:0046483', 'GO:0036094', 'GO:0140098', 'GO:0004857', 'GO:0038023', 'GO:0032504', 'GO:0030054', 'GO:0030334', 'GO:0032989', 'GO:0001944', 'GO:0015075', 'GO:0045088', 'GO:0005929', 'GO:0009986', 'GO:0051338', 'GO:0032879', 'GO:0046983', 'GO:0061024', 'GO:0016192', 'GO:0007155', 'GO:0006753', 'GO:0070887', 'GO:0051015', 'GO:0005524', 'GO:0030036', 'GO:0008017', 'GO:0031331', 'GO:0008285', 'GO:0043227', 'GO:0030900', 'GO:0016298', 'GO:0016887', 'GO:0071695', 'GO:0031669', 'GO:0051276', 'GO:0005576', 'GO:1903046', 'GO:0006412', 'GO:0045087', 'GO:0007507', 'GO:0009892', 'GO:0021700', 'GO:1903561', 'GO:0003008', 'GO:0080134', 'GO:0000166', 'GO:0015399', 'GO:0019207', 'GO:0023057', 'GO:0008270', 'GO:0004540', 'GO:0004674', 'GO:0071705', 'GO:0008324', 'GO:0008509', 'GO:0050789', 'GO:0003674', 'GO:0005911', 'GO:0051726', 'GO:0008289', 'GO:1990837', 'GO:0042277', 'GO:0043170', 'GO:0051239', 'GO:0097367', 'GO:0007017', 'GO:0034470', 'GO:0030234', 'GO:0005740', 'GO:0044087', 'GO:0009966', 'GO:0051051', 'GO:0043632', 'GO:0044419', 'GO:0042325', 'GO:0099503', 'GO:1901987', 'GO:0009887', 'GO:0048522', 'GO:0022402', 'GO:0044262', 'GO:0000785', 'GO:0030154', 'GO:0009888', 'GO:0010557', 'GO:0031329', 'GO:0051129', 'GO:0008757', 'GO:0015078', 'GO:0005789', 'GO:0061134', 'GO:0015079', 'GO:0046914', 'GO:0046943', 'GO:0006725', 'GO:1903829', 'GO:1903507', 'GO:0051172', 'GO:0061458', 'GO:0009886', 'GO:0009792', 'GO:0051301', 'GO:0001666', 'GO:0005342', 'GO:0031099', 'GO:0005488', 'GO:0098588', 'GO:0048519', 'GO:0007292', 'GO:0045937', 'GO:0001822', 'GO:0048736', 'GO:0045892', 'GO:0000287', 'GO:0006357', 'GO:0045786', 'GO:0050801', 'GO:0065009', 'GO:0005575', 'GO:0098796', 'GO:0006325', 'GO:0060627', 'GO:0048584', 'GO:0044089', 'GO:0019901', 'GO:0045321', 'GO:0019787', 'GO:0110165', 'GO:0034641', 'GO:0048646', 'GO:0051171', 'GO:0043233', 'GO:0032553', 'GO:0006508', 'GO:0009889', 'GO:0032991', 'GO:0048513', 'GO:0007420', 'GO:0140535', 'GO:0097305', 'GO:0043069', 'GO:0016810', 'GO:0031406', 'GO:0042626', 'GO:0051960', 'GO:0003713', 'GO:0070647', 'GO:0004519', 'GO:0043066', 'GO:0016053', 'GO:0009410', 'GO:0004518', 'GO:0048468', 'GO:0009056', 'GO:0060485', 'GO:1901615', 'GO:0016798', 'GO:0007275', 'GO:0072001', 'GO:0080090', 'GO:0016765', 'GO:0001558', 'GO:0015031', 'GO:0071363', 'GO:0030029', 'GO:0048870', 'GO:0033218', 'GO:0015103', 'GO:0030855', 'GO:0007049', 'GO:0048589', 'GO:0071417', 'GO:0097485', 'GO:0043177', 'GO:0007626', 'GO:0099512', 'GO:0003735', 'GO:0031090', 'GO:0010647', 'GO:0006886', 'GO:0017171', 'GO:0015291', 'GO:0032535', 'GO:0022890', 'GO:0016604', 'GO:0031328', 'GO:0016779', 'GO:0050896', 'GO:0006520', 'GO:0099537', 'GO:0008283', 'GO:0071554', 'GO:0006511', 'GO:0009896', 'GO:0005615', 'GO:0006163', 'GO:0006950', 'GO:0072359', 'GO:0005515', 'GO:0022832', 'GO:0001228', 'GO:0120039', 'GO:0043067', 'GO:0003682', 'GO:0001568', 'GO:0016740', 'GO:0043086', 'GO:0090407', 'GO:0030659', 'GO:0030674', 'GO:0048592', 'GO:0140096', 'GO:0014070', 'GO:0051247', 'GO:1902679', 'GO:0008284', 'GO:0019538', 'GO:0019438', 'GO:0009987', 'GO:0019953', 'GO:1901699', 'GO:0002165', 'GO:0098655', 'GO:2000026', 'GO:0015267', 'GO:0051248', 'GO:0040017', 'GO:0009259', 'GO:0032446', 'GO:0043167', 'GO:0004930', 'GO:0051213', 'GO:0098660', 'GO:0035107', 'GO:0016614', 'GO:0001664', 'GO:0050793', 'GO:0040008', 'GO:0010564', 'GO:0140013', 'GO:0005198', 'GO:0001654', 'GO:0009611', 'GO:0036477', 'GO:0019439', 'GO:0051050', 'GO:0043169', 'GO:0099402', 'GO:0120036', 'GO:0099080', 'GO:0005773', 'GO:0019748', 'GO:0005856', 'GO:0006873', 'GO:0008194', 'GO:0042592', 'GO:1901700', 'GO:0019725', 'GO:0007163', 'GO:1901575', 'GO:0005783', 'GO:0051668', 'GO:0016835', 'GO:0030163', 'GO:0060322', 'GO:0140640', 'GO:0043408', 'GO:0032555', 'GO:0000978', 'GO:0019900', 'GO:0051128', 'GO:0043043', 'GO:0009536', 'GO:0031175', 'GO:0005737', 'GO:0016741', 'GO:0007369', 'GO:0012506', 'GO:0098771', 'GO:0097159', 'GO:0010604', 'GO:0097435', 'GO:0004497', 'GO:0043604', 'GO:1902494', 'GO:0035091', 'GO:0061629', 'GO:2000145', 'GO:0016788', 'GO:0022834', 'GO:0030097', 'GO:0000977', 'GO:0043228', 'GO:0009719', 'GO:0050808', 'GO:0120025', 'GO:0031399', 'GO:0033554', 'GO:0042594', 'GO:0022412', 'GO:0015293', 'GO:0055082', 'GO:0006066', 'GO:0140297', 'GO:0000226', 'GO:0051649', 'GO:0007411', 'GO:0048666', 'GO:0007423', 'GO:1901652', 'GO:0016070', 'GO:0016043', 'GO:0005829', 'GO:0004842', 'GO:0031326', 'GO:0005244', 'GO:0006468', 'GO:0016071', 'GO:0051223', 'GO:0060090', 'GO:0048583', 'GO:0044092', 'GO:0051254', 'GO:0060562', 'GO:0002684', 'GO:0016773', 'GO:0007444', 'GO:0019899', 'GO:0006139', 'GO:0043412', 'GO:0009725', 'GO:1901135', 'GO:1902532', 'GO:0016477', 'GO:0043005', 'GO:0022839', 'GO:0007186', 'GO:0010975', 'GO:0070201', 'GO:0042221', 'GO:0048871', 'GO:0051146', 'GO:0043565', 'GO:0016758', 'GO:0070925', 'GO:0051641', 'GO:0062197', 'GO:0010817', 'GO:0046982', 'GO:0008610', 'GO:0051246', 'GO:0065010', 'GO:0140110', 'GO:0006970'])
# # z=np.array(['GO:0007399','GO:0061564','GO:2000145','GO:0007507','GO:0009887','GO:0040011','GO:0048666','GO:0003723','GO:0006793','GO:0031966','GO:0031325','GO:0032787','GO:0061061','GO:0005856','GO:0048731','GO:0007423','GO:0008284','GO:0045892','GO:1990837','GO:0051174','GO:0070887','GO:0003677','GO:0050794','GO:0042995','GO:0048878','GO:0031410','GO:0005794','GO:0030234','GO:0000902','GO:0000785','GO:0006811','GO:0006629','GO:0005515','GO:0010557','GO:0009536','GO:0045184','GO:0005759','GO:0005730','GO:0007610','GO:0036211','GO:0045893','GO:0031012','GO:0070727','GO:0044391','GO:0007166','GO:0016310','GO:0030029','GO:0051049','GO:0022803','GO:0019538','GO:0031975','GO:0060089','GO:0043229','GO:0140640','GO:0043232','GO:0016829','GO:0038023','GO:0044093','GO:0016604','GO:0097159','GO:0006955','GO:0007017','GO:0019953','GO:0035295','GO:0010604','GO:0006952','GO:0005615','GO:0071702','GO:0003729','GO:0003690','GO:0005654','GO:0009628','GO:0030030','GO:0007267','GO:0048646','GO:0031344','GO:1901363','GO:0006396','GO:0009617','GO:0009058','GO:0048584','GO:0051093','GO:0044877','GO:0140535','GO:0099080','GO:0016491','GO:0005102','GO:0005634','GO:0048522','GO:0045934','GO:0099081','GO:0007154','GO:0005813','GO:0008104','GO:0016020','GO:0000278','GO:0030036','GO:0048667','GO:0005215','GO:0071840','GO:0009056','GO:0033554','GO:0043233','GO:0048812','GO:0009894','GO:0031323','GO:0046872','GO:0065007','GO:1903047','GO:0048568','GO:0031399','GO:0043436','GO:0000904','GO:0051172','GO:0048585','GO:0055086','GO:0031326','GO:0032880','GO:0043227','GO:1901700','GO:0023057','GO:0072359','GO:0043565','GO:0070062','GO:0120039','GO:0042803','GO:0005773','GO:0032989','GO:0010629','GO:0110165','GO:0007276','GO:0050896','GO:0051649','GO:0031981','GO:0030154','GO:1903508','GO:0000976','GO:0050789','GO:0044255','GO:0098687','GO:0005667','GO:0003824','GO:0051247','GO:1902531','GO:0009986','GO:0030182','GO:0031667','GO:0005618','GO:0043228','GO:0009892','GO:1901362','GO:0009507','GO:0043067','GO:0031328','GO:0045935','GO:0022603','GO:0019899','GO:0099503','GO:0019725','GO:0012505','GO:1990904','GO:0010558','GO:0010564','GO:0042802','GO:0005198','GO:0009966','GO:0031982','GO:0005774','GO:0005929','GO:0003674','GO:0016740','GO:0051254','GO:1901575','GO:0034645','GO:0003006','GO:0003700','GO:0005815','GO:0051179','GO:0060322','GO:0009968','GO:0009791','GO:0060255','GO:0007409','GO:0080134','GO:0098796','GO:0022008','GO:0040012','GO:0046483','GO:0016043','GO:0022857','GO:0002684','GO:0005911','GO:0051641','GO:0009991','GO:0032504','GO:0000323','GO:0048471','GO:0006357','GO:0051246','GO:0034654','GO:0010035','GO:2000026','GO:0051726','GO:0031327','GO:0060429','GO:0051050','GO:0022402','GO:0048729','GO:0009057','GO:0048880','GO:0019867','GO:0019219','GO:0044248','GO:0016788','GO:0043168','GO:0016773','GO:0032501','GO:0007281','GO:0005737','GO:0048523','GO:0009888','GO:0014070','GO:0036477','GO:0048518','GO:0065003','GO:0051094','GO:0046983','GO:0150063','GO:0098798','GO:0008150','GO:0004672','GO:0022607','GO:0032502','GO:0008324','GO:0045595','GO:0007165','GO:0023056','GO:0002682','GO:0005840','GO:0060341','GO:0010647','GO:0048583','GO:0007420','GO:0070925','GO:0055085','GO:0000166','GO:0051241','GO:0043025','GO:0009987','GO:0006810','GO:0051716','GO:0007417','GO:0033993','GO:0060284','GO:0043167','GO:0031967','GO:0002376','GO:0046907','GO:0005829','GO:0030141','GO:0048699','GO:0042221','GO:1990234','GO:0005740','GO:1901702','GO:0006812','GO:0009653','GO:0050776','GO:0005743','GO:0019637','GO:0015318','GO:0048513','GO:0010033','GO:1901137','GO:0071704','GO:0051252','GO:0015629','GO:0140110','GO:0007010','GO:0023051','GO:0071495','GO:0019438','GO:0030054','GO:0040007','GO:0098794','GO:0008152','GO:0016477','GO:0005886','GO:0140096','GO:0080090','GO:0015630','GO:0010628','GO:0022412','GO:0010608','GO:1903506','GO:0043603','GO:0012506','GO:0032879','GO:0003002','GO:0045177','GO:0016070','GO:0140677','GO:0006974','GO:0120036','GO:0048858','GO:1901698','GO:0044260','GO:1901360','GO:0001654','GO:0009725','GO:0042175','GO:0022890','GO:0140657','GO:0007049','GO:0009607','GO:0008233','GO:0071705','GO:0042325','GO:0032101','GO:0048468','GO:0071310','GO:0098588','GO:2001141','GO:0009889','GO:1903507','GO:0006935','GO:1901565','GO:0048519','GO:0009416','GO:0042127','GO:0005694','GO:0044297','GO:0003008','GO:0048869','GO:0030312','GO:1902494','GO:0042592','GO:0035556','GO:0051128','GO:0006807','GO:1903561','GO:1901701','GO:0043005','GO:0022414','GO:1901265','GO:0006082','GO:0006796','GO:0043009','GO:0016301','GO:0009605','GO:0050877','GO:0001067','GO:0097708','GO:0034641','GO:0030659','GO:0015267','GO:0010243','GO:0009967','GO:0009891','GO:0009314','GO:0051248','GO:0005938','GO:0048856','GO:0097367','GO:0006725','GO:0032991','GO:0004888','GO:0044237','GO:0010648','GO:0065008','GO:0010468','GO:0031175','GO:0009890','GO:0098797','GO:0035239','GO:0048609','GO:0090304','GO:0016192','GO:0120025','GO:0030097','GO:0098793','GO:0008092','GO:0006355','GO:0018130','GO:0044249','GO:0003676','GO:0099512','GO:0009059','GO:0045944','GO:1901564','GO:0070161','GO:0019866','GO:0044283','GO:0043170','GO:0005622','GO:0044085','GO:0065009','GO:0005975','GO:0017076','GO:0032838','GO:0009790','GO:0009792','GO:0050793','GO:1902679','GO:0000003','GO:0051707','GO:0044281','GO:0010605','GO:0097014','GO:0060548','GO:1901576','GO:0042330','GO:0051234','GO:0006139','GO:0005764','GO:0009893','GO:0051240','GO:0043169','GO:0040008','GO:0050790','GO:0010556','GO:0015031','GO:0036094','GO:0061458','GO:0010646','GO:0051253','GO:0032990','GO:0005739','GO:0043933','GO:0031974','GO:0042981','GO:0030855','GO:0044238','GO:0010467','GO:0031347','GO:0031090','GO:1901566','GO:0051239','GO:1902680','GO:0033043','GO:0023052','GO:0043231','GO:0051130','GO:0001932','GO:0002009','GO:0016787','GO:0098772','GO:0005488','GO:0007275','GO:0045202','GO:0031324','GO:0140513','GO:0009719','GO:0033036','GO:0043226','GO:0005783','GO:0051173','GO:0005768','GO:0098827','GO:0019222','GO:0044087','GO:0005575','GO:0051171','GO:0065010','GO:0005635','GO:0008610','GO:0005576','GO:0007389','GO:0030425','GO:0043069','GO:0048589','GO:1901135','GO:0098590','GO:1901615','GO:0044419','GO:0006996','GO:0006950','GO:0010941','GO:0006508','GO:0048870','GO:0070013','GO:0043412','GO:0031984','GO:0015075','GO:0044265','GO:0030424','GO:0071944','GO:0099568','GO:0048598','GO:0044271','GO:0006259','GO:0016772','GO:0043207','GO:0019220','GO:0005789','GO:0043230','GO:0048608','GO:0098542','GO:0019752','GO:0097447'])
# u=np.array(['GO:0006725','GO:0003002','GO:0060589','GO:0008233','GO:0120025','GO:2001141','GO:0055085','GO:0007399','GO:1903506','GO:0008219','GO:0031982','GO:0051234','GO:0005737','GO:0071840','GO:0048523','GO:1903508','GO:0031324','GO:0031399','GO:0009893','GO:0019222','GO:0010605','GO:0007507','GO:0009888','GO:0031325','GO:0003700','GO:0046872','GO:1901564','GO:0035295','GO:0030154','GO:0098588','GO:0016817','GO:0031347','GO:0005198','GO:0009416','GO:0009059','GO:0048699','GO:0046873','GO:0098772','GO:0005216','GO:0015031','GO:0003729','GO:0055086','GO:0031410','GO:0005694','GO:0051174','GO:0002376','GO:0033043','GO:0016746','GO:0006807','GO:0010648','GO:0050790','GO:0023052','GO:0007417','GO:0019752','GO:0015318','GO:0045595','GO:0009987','GO:0016192','GO:0000978','GO:0009968','GO:0005615','GO:0031967','GO:0004674','GO:0036094','GO:0003690','GO:0004672','GO:0016758','GO:0016787','GO:0007267','GO:0004842','GO:0036211','GO:0043603','GO:0009790','GO:0046983','GO:0030554','GO:0005829','GO:0008324','GO:0043170','GO:0017076','GO:0019904','GO:0120036','GO:0006082','GO:0098542','GO:2000026','GO:0032879','GO:0031981','GO:0060548','GO:0051254','GO:0043604','GO:1902531','GO:0051649','GO:0044260','GO:0016757','GO:0065008','GO:0005783','GO:1901702','GO:0009889','GO:0016829','GO:0007423','GO:0007010','GO:0030234','GO:0019787','GO:0043933','GO:0120035','GO:0032991','GO:0045944','GO:0140513','GO:0048518','GO:0044271','GO:1901565','GO:0003712','GO:0010628','GO:0051241','GO:0009892','GO:0006793','GO:0006974','GO:0022804','GO:0005488','GO:0009607','GO:0033993','GO:0009617','GO:0010558','GO:0044238','GO:0032501','GO:0008134','GO:0034645','GO:0006811','GO:0009725','GO:0032990','GO:0043167','GO:0044265','GO:0022402','GO:0060089','GO:0043228','GO:0007275','GO:0031326','GO:1901576','GO:0022890','GO:0005654','GO:0071310','GO:0048856','GO:0048568','GO:0051726','GO:0033036','GO:0065009','GO:0060341','GO:0019899','GO:0002009','GO:0023051','GO:0043069','GO:0016818','GO:0006629','GO:0038023','GO:0005634','GO:0002684','GO:0007409','GO:0048731','GO:0048589','GO:0006810','GO:0003674','GO:0016310','GO:0015075','GO:0010647','GO:0007389','GO:0031667','GO:0050789','GO:0016741','GO:0019220','GO:0019725','GO:0009653','GO:0044085','GO:0005215','GO:0051172','GO:0048646','GO:0000226','GO:0017111','GO:0044419','GO:1901615','GO:0009894','GO:0043226','GO:0051707','GO:0042221','GO:0043227','GO:0019438','GO:0045184','GO:0003677','GO:0044255','GO:1902680','GO:0051171','GO:0023057','GO:0051128','GO:0040007','GO:0009891','GO:0097708','GO:0019953','GO:0023056','GO:0048869','GO:0009967','GO:1990837','GO:0140297','GO:0048468','GO:0065003','GO:0022603','GO:0022008','GO:0043412','GO:0007610','GO:0008284','GO:0042325','GO:0009057','GO:0008047','GO:0010629','GO:0015267','GO:0140098','GO:0045893','GO:0044283','GO:0006259','GO:0060090','GO:0022839','GO:0006955','GO:0031090','GO:0009791','GO:0060284','GO:0003676','GO:0043436','GO:0005975','GO:0048609','GO:0030097','GO:0048608','GO:0044281','GO:0010604','GO:0030054','GO:0005575','GO:0019219','GO:0061061','GO:0043233','GO:0071704','GO:0080134','GO:0016477','GO:0005886','GO:0042981','GO:0140096','GO:0016798','GO:0051239','GO:0007276','GO:0016772','GO:0031975','GO:0140110','GO:0003682','GO:0050794','GO:0030182','GO:0012505','GO:0016740','GO:0048667','GO:0090304','GO:0048666','GO:0048519','GO:0048583','GO:0051248','GO:0043085','GO:0004888','GO:0016491','GO:0048880','GO:1903047','GO:0042578','GO:0006508','GO:0048729','GO:0031974','GO:0016462','GO:0016301','GO:0051130','GO:0032787','GO:0006996','GO:0110165','GO:0005622','GO:0045597','GO:0008092','GO:0008289','GO:0071702','GO:0050793','GO:0005739','GO:0043232','GO:0060255','GO:0042802','GO:0140677','GO:1902679','GO:0048870','GO:0005515','GO:0070727','GO:0009890','GO:0048878','GO:1901265','GO:0032502','GO:0018130','GO:0140640','GO:0019538','GO:0045202','GO:0042995','GO:0048585','GO:0006357','GO:0006952','GO:0005261','GO:0032989','GO:0034660','GO:0051240','GO:0070887','GO:0016614','GO:0045935','GO:0031344','GO:0006812','GO:1901363','GO:0048812','GO:0006935','GO:0010035','GO:0006468','GO:1902494','GO:0030312','GO:1901137','GO:0044237','GO:0006950','GO:0043067','GO:0005794','GO:0042592','GO:0000987','GO:0001216','GO:0065007','GO:0072359','GO:0051093','GO:0043207','GO:0042803','GO:0140678','GO:0022836','GO:0051179','GO:0045934','GO:0031175','GO:0032559','GO:0051246','GO:0005102','GO:0009058','GO:0010033','GO:0001932','GO:0044249','GO:0016043','GO:0004930','GO:0014070','GO:0010557','GO:0048584','GO:0001944','GO:0008104','GO:0030855','GO:0050896','GO:0033554','GO:1901575','GO:0008152','GO:0030030','GO:0046907','GO:0099080','GO:1901566','GO:0150063','GO:0043231','GO:0032553','GO:0010468','GO:0007281','GO:0051716','GO:0007166','GO:0000166','GO:0031327','GO:0040008','GO:0070925','GO:0048513','GO:0008610','GO:0042330','GO:0051253','GO:0080090','GO:0071944','GO:0000977','GO:0097159','GO:0000976','GO:0009719','GO:0003723','GO:0042127','GO:0009605','GO:0050776','GO:0034641','GO:0016773','GO:0046483','GO:0006396','GO:0009966','GO:0010941','GO:0048598','GO:0035239','GO:0000278','GO:0009792','GO:0035639','GO:0051049','GO:0016020','GO:0003006','GO:0071705','GO:0010243','GO:0040012','GO:0040011','GO:0030036','GO:1901698','GO:1901700','GO:0005856','GO:0060322','GO:0044248','GO:0044093','GO:0000904','GO:0000902','GO:2000145','GO:0030695','GO:0032880','GO:0019900','GO:0007017','GO:0043229','GO:0051094','GO:0005576','GO:0009628','GO:0022803','GO:1901362','GO:0007154','GO:0032555','GO:0009314','GO:0043005','GO:1901135','GO:0060429','GO:0009056','GO:0030029','GO:0045892','GO:0016788','GO:0016705','GO:0043009','GO:0051252','GO:0016874','GO:0051247','GO:0009887','GO:0010564','GO:0002682','GO:0000003','GO:0019637','GO:0120039','GO:0044877','GO:0007420','GO:0140657','GO:0048522','GO:0006796','GO:0007049','GO:0048858','GO:0022857','GO:0010608','GO:0031323','GO:0051641','GO:0035556','GO:0032101','GO:0070013','GO:0007165','GO:1901701','GO:0000122','GO:0061458','GO:0015630','GO:0016747','GO:0051173','GO:0046914','GO:0009266','GO:0051050','GO:0031328','GO:0016070','GO:0001654','GO:0008150','GO:0022607','GO:1903507','GO:0061564','GO:0019901','GO:0050877','GO:0043168','GO:0043565','GO:0071495','GO:0003824','GO:0033365','GO:0006355','GO:0044087','GO:0034654','GO:0010556','GO:0032504','GO:0022412','GO:0022414','GO:0000981','GO:1901360','GO:0003008','GO:0097435','GO:0140097','GO:0009991','GO:0004175','GO:0016791','GO:0001067','GO:0010467','GO:0010646','GO:0006139','GO:0043169','GO:0097367'])
# print(len(np.intersect1d(x,u)))

# y=torch.rand(3,3)
# print(x)
# print(y)
# x=generate_labels(r'C:\Users\23920\Desktop\research\demo\dataset\cafa-5-protein-function-prediction\Train\train_terms.tsv',label='term',by=['aspect'],k=500,show=True)
# print(x)
# pd.set_option('display.max_rows', None)
# pd.set_option('display.max_columns', None)
# df = pd.DataFrame()
# df['aspect'] = np.random.choice(['A','A', 'B', 'C'], 100)
# df['aspect2'] = np.random.choice(['A', 'B'], 100)
# df['label'] =list(np.arange(45))*2+[1,2,3,4,5,6,7,8,9,10]
#     # np.random.choice(['a', 'b', 'c','d'], 100)
# df['v'] = np.random.choice(np.arange(31), 100)
# # df['F1'] = np.arange(100)
# # df['F2'] = np.random.randn(100)
# # df['F3'] = [("123","123","123") for i in range(100)]
# df.to_csv('./x.csv')
# # print(df.groupby(['aspect'])['label'].count())
# print(generate_labels('',label='label',by=['aspect','aspect2'],k=10,show=True))







































